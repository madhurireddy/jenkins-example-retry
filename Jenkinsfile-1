pipeline {
  agent any
  stages {
    stage('stage 1') {
      steps {
        sh 'echo stage 1'
      }
    }
    stage('stage 2') {
      steps {
        retry(5) {
	
	  sh 'timestamp=$(date +%s); if (\'expr $timestamp % 2\' == 0);then exit 0;else sleep 1; exit 1; fi'
          
        }
      }
    }
    stage('stage 3') {
      steps {
        sh 'echo stage 3'
      }
    }
  }
}
